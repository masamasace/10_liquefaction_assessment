<!DOCTYPE html>
<html lang="jp">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import Borehole Data</title>
</head>
<body>
    <!-- File input for selecting XML file -->
    <input type="file" id="fileInput" accept=".xml" />

    <!-- Table to display the extracted data -->
    <table id="dataTable" border="1">
        <thead>
            <tr>
                <th>標準貫入試験_開始深度</th>
                <th>標準貫入試験_合計打撃回数</th>
                <th>2N</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data rows will be inserted here -->
        </tbody>
    </table>

    <script>
        document.getElementById('fileInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const uint8Array = new Uint8Array(e.target.result);
                    const decoder = new TextDecoder('shift_jis');
                    const content = decoder.decode(uint8Array);

                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(content, "text/xml");

                    // Extract and display data
                    const tests = xmlDoc.getElementsByTagName('標準貫入試験');
                    const tableBody = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
                    tableBody.innerHTML = ''; // Clear existing rows

                    for (let i = 0; i < tests.length; i++) {
                        const startDepth = tests[i].getElementsByTagName('標準貫入試験_開始深度')[0].textContent;
                        const totalHits = tests[i].getElementsByTagName('標準貫入試験_合計打撃回数')[0].textContent;

                        const row = tableBody.insertRow();
                        const cell1 = row.insertCell(0);
                        const cell2 = row.insertCell(1);
                        const cell3 = row.insertCell(2);

                        cell1.textContent = startDepth;
                        cell2.textContent = totalHits;
                        cell2.contentEditable = true; // Make the cell editable
                        cell3.textContent = totalHits * 2;

                        // Add event listener to update 2N column when totalHits is edited
                        cell2.addEventListener('input', function() {
                            const newTotalHits = parseFloat(cell2.textContent) || 0;
                            cell3.textContent = newTotalHits * 2;
                        });
                    }
                };
                reader.readAsArrayBuffer(file);
            }
        });
    </script>
</body>
</html>
